<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<!-- Converted to html 4.01 Transitional by Burton Strauss, Feb2002 -->
<!-- Validated as HTML 4.01 Transitional by Burton Strauss, 26Feb2002 -->
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="Expires" content="0">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Window-target" content="_top">
<meta name="ROBOTS" content="NOINDEX,NOFOLLOW">
<meta name="description" content="ntop (http://www.ntop.org) status for a network.">
<meta name="author" content="ntop">
<meta name="generator" content="ntop">
<link rel="stylesheet" type="text/css" href="/style.css">
</head>
<title>ntop help information</title>

<body background=white_bg.gif>

<h1><a href="http://www.ntop.org/" target="_top"><img border="0" src="ntop.gif" width="59" height="49" alt="ntop logo"></a>
ntop Error Codes</h1>

<p>Note that many of these warnings can be produced if a mirrored (Cisco span) traffic source is 
being monitored and the -o flag is <b>not</b> specified.  In this case, the MAC layer address
for packets is incorrect and will confuse <b>ntop</b>.</p>
<hr />
<ol>
<h3><a name="#1">Wrong network mask or bridging enabled</a></h3>
<p><b>ntop</b> will report this problem for those hosts that apparently have a wrong
netmask. <b>ntop</b> detects this problem when a host sends a packet to a broadcast
address where the destination MAC address is not FF:FF:FF:FF:FF:FF. This could
indicate that: 
<ul><li>such host has a wrong netmask</li>
<li>it is a bridge.</li></ul></p>
<h3><a name="#2">Duplicated MAC found for this IP address</a></h3>
<b>ntop</b> will report this problem for hosts where a single MAC address is found on
packets from several IP addresses. This could indicate that: 
<ul><li>The host legitimately has multiple IPs assigned.</li>
<li>Someone is sending spoofed packets.</li>
<li>A host has a wrong netmask.</li></ul></p>
<p>Using the wrong netmask is quite common on networks where the
netmask has changed and some of the hosts still use the old netmask.</p>
<p>Most hosts use the netmask to determine the gateway router address, by setting the 
host portion of the address to 0x1 (i.e. the gateway for 192.168.1.1/24 is 192.168.1.1).
If problems do occur, selecting the wrong gateway for non-local packets usually leads to
apparent failure of the entire non-local network (support call: "The network is down").
It can also cause high packet loss, collisions, ttl expiration and other network problems.</p>
<h3><a name="#3">Traffic on suspicious IP ports</a></h3>
<p><b>ntop</b> will report this problem for those hosts that produced traffic on ports where 
we should see no traffic (e.g. port zero).</p>
<h3><a name="#4">Suspicious activities: too many host contacts</a></h3>
Usually a host contacts a limited number of hosts in a short amount of time. This flag indicates
that the flagged host has contacted a large number of hosts.</p>
<p>This is not always a problem - some servers (e.g. DNS/SMTP servers) may routinely contact
100s or 1000s of hosts in performance of their function. Hosts running PP applications, 
often contact many different hosts to resolve a request.</p>
<p>However, this behavior - contacting many different hosts in a short period - is also 
indicative of a worm.  If you see this flag, you should carefully analyze the host in order 
to see whether it is infected.</p>
<h3><a name="#5">Unexpected packets</a></h3>
<p>There are a large number of causes for this flag which indicates that one or more of the 
following conditions have occurred.  The specific condition or conditions are indicated by short 
tags on the host information report:</p>
<table border="1">
<tr><th width=100>Tag</th><th>Description</th><th>Counter</th></tr>
<tr>
<tr><td valign="top">(Sent:syn-fin)</td>
<td><b>ntop</b> has seen one or more packets with both the <i>SYN</i> and <i>FIN</i> flags set.
This violates the tcp/ip protocol and is most often part of a port scan or denial of service
attack. The flagged host is the SENDER of these malformed packets and should be investigated.</td>
<td valign="bottom">synFinPktsSent</td></tr>

<tr><td valign="top">(Rcvd:rst)</td>
<td><b>ntop</b> has seen one or more packets with the <i>RST</i> flag set.  This can be normal,
although should be rare.  A large number of RST packets is also seen as part of a port scan.  
The flagged host is the RECEIVER of these packets and is the machine being scanned.</td>
<td valign="bottom">rstPktsRcvd</td></tr>

<tr><td valign="top">(Sent:xmas)</td>
<td><b>ntop</b> has seen one or more packets with unusual combinations of flags. This is usually
seen as part of a port scan.  The flagged host is the SENDER of these packets is the
machine performing the port scan.</td>
<td valign="bottom">ackXmasFinSynNullScanSent</td></tr>

<tr><td valign="top">(Rcvd:rejected)</td>
<td><b>ntop</b> has seen one or more packets with the <i>ACK</i> and <i>RST</i> flags set.
This usually means that the contacted host has rejected the tcp session initiation and does
not indicate a problem.  A high count should be looked at - perhaps a machine is attempting
to contact a host which used to provide a service (e.g. ntp).
</td>
<td valign="bottom">rejectedTCPConnRcvd</td></tr>

<tr><td valign="top">(Sent:udp to closed)</td>
<td><b>ntop</b> has seen one or more ICMP <i>Destination Unreachable</i> replies.  This means
that the flagged host has SENT a packet to a remote host's port that is not accepting these
connections.  It is usually seen when there is a misconfiguration of the sending host, such as
the wrong dns server address.</td>
<td valign="bottom">udpToClosedPortRcvd</td></tr>

<tr><td valign="top">(Sent:udp to diag)</td>
<td><b>ntop</b> has seen one or more packets SENT by the flagged host to the 'diagnostic'
ports, that is to/from port 7 or to ports 9, 13 or 19.  When the internet was a smaller,
friendlier place, these provided trivial information and ways to check if a remote machine
was operational.  These are rarely seen today and so are flagged.</td>
<td valign="bottom">udpToDiagnosticPortSent</td></tr>

<tr><td valign="top">(Sent:Tiny frag)</td>
<td><b>ntop</b> has seen one or more tiny fragments (that is 128 or fewer octets) SENT
from the flagged host.  This is not normal and can indicate a misconfigured router or
other device, or can be part of an attack (tiny fragments have been used to slip hostile
packets past firewalls).  Check it out.</td>
<td valign="bottom">tinyFragmentSent</td></tr>

<tr><td valign="top">(Sent:icmp frag)</td>
<td><b>ntop</b> has seen one or more fragmented ICMP packets SENT by the flagged host.
ICMP packets are small and under normal operations should never be fragmented.
This is either a misconfigured router/device or hostile. Check it out.</td>
<td valign="bottom">icmpFragmentSent</td></tr>

<tr><td valign="top">(Sent: overlapfrag)</td>
<td><b>ntop</b> has seen one or more packets SENT by the flagged host where the fragments
overlap.  It's possible, but rare, to see this on network links which have problems, where
lost packets are causing retransmission errors - perhaps <b>ntop</b> is seeing a fragment that
never makes it to the end station.  But it should be very, very, rare.  This has also
been used to crash Intrusion Detection Systems (IDS) prior to an attack.</td>
<td valign="bottom">overlappingFragmentSent</td></tr>

<tr><td valign="top">(Sent:closed-empty)</td>
<td><b>ntop</b> has seen one or more sessions established by the flagged host where no
data was actually sent or received.  This can happen, but is most often part of a 
attempt to map a network.  <b>ntop</b> does not differentiate between the host performing
the scan and the host being scanned, so it should be investigated with the understanding
that your user might have been the target, not the perpetrator.</td>
<td valign="bottom">closedEmptyTCPConnSent</td></tr>

<tr><td valign="top">(Rcvd:port unreac)</td>
<td><b>ntop</b> has seen one or more ICMP <i>Port Unreachable</i> messages.  These are perfectly
legal, although optional according to the standard.  It means that the packet sent FROM the
flagged host reached it's intended destination, but there was no process configured on that
host to accept it.  The remote process could have died or something else could have happened.
However, most machines don't return this and many routers filter it out since it can be used
to map remote networks.</td>
<td valign="bottom">icmpPortUnreachRcvd</td></tr>

<tr><td valign="top">(Rcvd:hostnet unreach)</td>
<td><b>ntop</b> has seen one or more ICMP <i>Host Unreachable</i> or <i>Network Unreachable</i>
messages.  Again, perfectly legal although often filtered.  Means that the host the flagged
machine was attempting TO connect to doesn't exist. Large numbers of these can sometimes
indicate a worm program attempting to spread by contacting random IP addresses.</td>
<td valign="bottom">icmpHostNetUnreachRcvd</td></tr>

<tr><td valign="top">(Rcvd:proto unreac)</td>
<td><b>ntop</b> has seen one or more ICMP <i>Protocol Unreachable</i> messages.  These are 
perfectly legal, although optional according to the standard.  It means that the packet sent 
FROM the flagged host reached it's intended destination, but there was no process configured
on that host to accept the protocol it used.  However, most machines don't return this and 
many routers filter it out since it can be used to map remote networks.</td>
<td valign="bottom">icmpProtocolUnreachRcvd</td></tr>

<tr><td valign="top">(Rcvd:admin prohib)</td>
<td><b>ntop</b> has seen one or more ICMP <i>Host Administratively Prohibited</i> or
<i>Net Administratively Prohibited</i> messages.  These are obsolete and shouldn't be seen
(there's a newer, rarely used code that indicates the request was filtered).  Since it's
unusual, you should investigate.</td>
</td>
<td valign="bottom">icmpAdminProhibitedRcvd</td></tr>

<tr><td valign="top">(Rcvd:malformed)</td>
<td><b>ntop</b> has seen one or more malformed packets, that is packets where the length
field indicates a length less than the minimum header length for that type of packet. This may
be set for TCP, UDP and/or ICMP packets. The flagged host is the RECEIVER of these
packets, which often indicate a failing router or bad network connection.</td>
<td valign="bottom">malformedPktsRcvd</td></tr>

</table>

</body>
</html>
