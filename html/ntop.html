<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title>NTOP</title>
</head>
<body>

<h1 align=center>NTOP</h1>
<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#COMMAND&minus;LINE OPTIONS">COMMAND&minus;LINE OPTIONS</a><br>
<a href="#WEB VIEWS">WEB VIEWS</a><br>
<a href="#NOTES">NOTES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#USER SUPPORT">USER SUPPORT</a><br>
<a href="#AUTHOR">AUTHOR</a><br>
<a href="#LICENCE">LICENCE</a><br>
<a href="#ACKNOWLEDGMENTS">ACKNOWLEDGMENTS</a><br>

<hr>
<!-- Creator     : groff version 1.18 -->
<!-- CreationDate: Tue Aug 12 16:40:44 2003 -->
<a name="NAME"></a>
<h2>NAME</h2>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p>ntop &minus; display top network users</p>
</td>
</table></p>
<a name="SYNOPSIS"></a>
<h2>SYNOPSIS</h2>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>ntop</b> [<b>@filename</b>]
[<b>-a</b>|<b>--access-log-path</b> <i>&lt;path&gt;</i>]
[<b>-b</b>|<b>--disable-decoders</b>]
[<b>-c</b>|<b>--sticky-hosts]</b>
[<b>-f</b>|<b>--traffic-dump-file</b> <i>file&gt;</i>]
[<b>-g</b>|<b>--track-local-hosts</b>]
[<b>-h</b>|<b>--help</b>]
[<b>-k</b>|<b>--filter-expression-in-extra-frame</b>]
[<b>-l</b>|<b>--pcap-log</b> <i>&lt;path&gt;</i>]
[<b>-m</b>|<b>--local-subnets</b> <i>&lt;addresses&gt;</i>]
[<b>-n</b>|<b>--numeric-ip-addresses</b>]
[<b>-o</b>|<b>--no-mac</b>] [<b>-p</b>|<b>--protocols</b>
<i>&lt;list&gt;</i>]
[<b>-q</b>|<b>--create-suspicious-packets</b>]
[<b>-r</b>|<b>--refresh-time</b> <i>&lt;number&gt;</i>]
[<b>-s</b>|<b>--no-promiscuous</b>]
[<b>-t</b>|<b>--trace-level</b> <i>&lt;number&gt;</i>]
[<b>-w</b>|<b>--http-server</b> <i>&lt;port&gt;</i>]
[<b>-z</b>|<b>--disable-sessions</b>]
[<b>-A</b>|<b>--set-admin-password</b> <i>password</i>]
[<b>-B</b>|<b>--filter-expression</b> <i>expression</i>]
[<b>-D</b>|<b>--domain</b> <i>&lt;name&gt;</i>]
[<b>-F</b>|<b>--flow-spec</b> <i>&lt;specs&gt;</i>]
[<b>-M</b>|<b>--no-interface-merge</b>]
[<b>-O</b>|<b>----output-packet-path</b>]
[<b>-P</b>|<b>--db-file-path</b> <i>&lt;path&gt;</i>]
[<b>-Q</b>|<b>--spool-file-path</b> <i>&lt;path&gt;</i>]
[<b>-R</b>|<b>--filter-rule</b> <i>&lt;file&gt;</i>]
<i>&lt;number&gt;</i>] [<b>-U</b>|<b>--mapper</b>
<i>&lt;URL&gt;</i>] [<b>-V</b>|<b>--version]</b>
[<b>--disable-stopcap</b>] [<b>--log-extra</b>
<i>&lt;number&gt;</i>]</p>
<!-- INDENTATION -->
<p>Unix options:</p>
<!-- INDENTATION -->
<p>[<b>-d</b>|<b>--daemon</b>] [<b>-i</b>|<b>--interface</b>
<i>&lt;name&gt;</i>] [<b>-u</b>|<b>--user</b>
<i>&lt;user&gt;</i>]
[<b>-E</b>|<b>--enable-external-tools</b>]
[<b>-K</b>|<b>--enable-debug</b>] [<b>-L</b>]
[<b>-use-syslog</b> <i>&lt;facility&gt;</i>]
[<b>--ignore-sigpipe</b>]</p>
<!-- INDENTATION -->
<p>Win32 option:</p>
<!-- INDENTATION -->
<p>[<b>-i</b>|<b>--interface</b>
<i>&lt;number|name&gt;</i>]</p>
<!-- INDENTATION -->
<p>OpenSSL options:</p>
<!-- INDENTATION -->
<p>[<b>-W</b>|<b>--https-server</b> <i>&lt;port&gt;</i>]</p>
</td>
</table></p>
<a name="DESCRIPTION"></a>
<h2>DESCRIPTION</h2>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>ntop</b> shows the current network usage. It displays
a list of hosts that are currently using the network and
reports information concerning the (IP and non-IP) traffic
generated by each host. <b>ntop</b> may operate as a
front-end collector (sFlow and/or netFlow plugins) or as a
stand-alone collector/display program. A web browser is
needed to access the information captured by the <b>ntop</b>
program.</p>
</td>
</table></p>
<a name="COMMAND&minus;LINE OPTIONS"></a>
<h2>COMMAND&minus;LINE OPTIONS</h2>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>@filename</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>The text of <b>filename</b> is copied - ignoring line
breaks and comment lines (anything following a #) - into the
command line. <b>ntop</b> behaves as if all of the text had
simply been typed directly on the command line. For example,
if the command line is &quot;-t 3 @d -u ntop&quot; and file
d contains just the line &rsquo;-d&rsquo;, then the
effective command line is -t 3 -d -u ntop. Multiple @s are
permitted.</p>
<!-- INDENTATION -->
<p>Remember, most <b>ntop</b> options are
&quot;sticky&quot;, that is they just set an internal flag.
Invoking them multiple times doesn&rsquo;t change
<b>ntop&rsquo;s</b> behavior. However, options that set a
value, such as --trace-level, will use the LAST value given:
--trace-level 2 --trace-level 3 will run as --trace-level
3.</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-a | --access-log-path</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>By default <b>ntop</b> does not maintain an http log. Use
this flag to specify the path of the file where HTTP
accesses will be logged. Each log entry is in Apache-like
style. The only difference between Apache and <b>ntop</b> is
that an additional column has been added which has the time
(in milliseconds) that <b>ntop</b> needed in order to serve
the request.</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-b | --disable-decoders</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>This flag disables protocol decoders (e.g. DNS, NetBIOS).
Use it for better performance or if you feel <b>ntop</b> has
problem handling some protocols.</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-c | --sticky-hosts</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>By default idle hosts are periodically purged from
memory. Use this flag to prevent idle hosts from being
purged from memory. NOTE: if idle hosts are kept in memory
you can experience severe memory usage.</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-d | --daemon</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>This flag causes ntop to become a daemon, i.e. it is
started in background and runs detached from the
terminal.</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-e | --max-table-rows</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>Is the maximum number of HTML table rows that <b>ntop</b>
will display.</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-f | --traffic-dump-file</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>Specifies the file containing tcpdump captured traffic
that has to be used by ntop. NOTE: if you specify -f ntop
will not capture any traffic after the file has been read.
This option is mostly used for debug purposes.</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-g | --track-local-hosts</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>Use this flag to tell <b>ntop</b> that you do care only
about local hosts (use -m to specify local nets). This flag
is useful on large networks or those that see many hosts,
(e.g. a border router or gateway), yet only the local ones
need to be tracked.</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-h | --help</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>Print help information for <b>ntop</b> , including
usage.</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-i | --interface</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>Specifies the network interface used by <b>ntop</b></p>
<!-- INDENTATION -->
<p>If multiple interfaces are used (this feature is
available only if ntop is compiled with thread support)
their names must be separated with a comma. For instance -i
&quot;eth0,lo&quot;.</p>
<!-- INDENTATION -->
<p>By default, traffic information obtained by all the
interfaces is merged together as if the traffic were seen by
only one interface. Use the -M flag to keep traffic separate
by interface.</p>
<!-- INDENTATION -->
<p>Win32 note: This is can be either the number of the
interface or its name. Run <b>ntop</b> -h to see a list of
interface name-number mappings (at the end of the help
information).</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-k | --filter-expression-in-extra-frame</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>When this flag is used, the current filter expression is
printed in an extra frame and thus always visible.</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-l | --pcap-log</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>Dumps the network traffic captured by ntop in a file in
pcap format (useful for debug).</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-m | --local-subnets</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>This flag allows users to specify the subnets whose
traffic is considered local. The format is &lt;network
address&gt;/&lt;# subnet mask bits&gt;[,&lt;network
address&gt;/&lt;# subnet mask bits&gt;]. Both netmasks and
CIDR notation may be used, for instance
&quot;131.114.21.0/24,10.0.0.0/255.0.0.0&quot;.</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-n | --numeric-ip-addresses</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>This causes <b>ntop</b> to show numeric IP addresses
instead of the symbolic names. This option can useful when
the DNS is not present or quite slow.</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-o | --no-mac</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>Specifies the user <b>ntop</b> should not trust MAC
addresses but just IP addresses. This option is useful
whenever ntop is started on an interface where MAC addresses
cannot be really trusted (e.g. port/VLAN mirror).</p>
<!-- INDENTATION -->
<p>Be aware that information which is dependent upon the MAC
addresses (such as IPX) will not be collected nor
displayed.</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-p | --protocols</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>It is used to specify the TCP/UDP protocols that
<b>ntop</b> will monitor. The format is
&lt;label&gt;=&lt;protocol list&gt; [,
&lt;label&gt;=&lt;protocol list&gt;], where label is used to
symbolically identify the &lt;protocol list&gt;. The format
of &lt;protocol list&gt; is
&lt;protocol&gt;[|&lt;protocol&gt;], where &lt;protocol&gt;
is either a valid protocol specified inside the
/etc/services file or a numeric port range (e.g. 80, or
6000-6500). If the -p flag is omitted the following default
value is used:</p>
<!-- INDENTATION -->
<p>FTP=ftp|ftp-data HTTP=http|www|https|3128 3128 is Squid,
the HTTP cache DNS=name|domain Telnet=telnet|login
NBios-IP=netbios-ns|netbios-dgm|netbios-ssn
Mail=pop-2|pop-3|pop3|kpop|smtp|imap|imap2 DHCP-BOOTP=67-68
SNMP=snmp|snmp-trap NNTP=nntp
NFS=mount|pcnfs|bwnfs|nfsd|nfsd-status X11=6000-6010
SSH=22</p>
<!-- INDENTATION -->
<p>Peer-to-Peer Protocols ----------------------
Gnutella=6346|6347|6348 Kazaa=1214 WinMX=6699|7730
DirectConnect=0 Dummy port as this is a pure P2P protocol
eDonkey=4661-4665</p>
<!-- INDENTATION -->
<p>Instant Messenger -----------------
Messenger=1863|5000|5001|5190-5193</p>
<!-- INDENTATION -->
<p>If the &lt;protocol list&gt; is very long you may store
it in a file (for instance protocol.list). To do so, specify
the file name instead of the &lt;protocol list&gt; on the
command line. e.g. <b>ntop</b> -p protocol.list instead of
<b>ntop</b> -p FTP=ftp|ftp-data,HTTP=http|www|https|3128
...</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-q | --create-suspicious-packets</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>Forces ntop to create a file
ntop-suspicious-pkts.XXX.pcap (XXX is the interface name)
file. One file is created for each network interface where
suspicious packets are found. The file is in pcap format
(tcpdump).</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-r | --refresh-time</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>Specifies the delay (in seconds) between screen updates
(the default is 3 seconds).</p>
<!-- INDENTATION -->
<p>Please note that if the delay is very short (1 second for
instance), ntop might not be able to process all the network
traffic.</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-s | --no-promiscuous</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>Use this flag for preventing from setting the
interface(s) into promiscuous mode.</p>
<!-- INDENTATION -->
<p><b>ntop</b> must probably still be started as root, since
the libpcap function on most systems require it to capture
raw packets.</p>
<!-- INDENTATION -->
<p>This eliminates the ability of capturing ethernet frames
regardless of whether they are directed to the local
ethernet card or to the ethernet broadcast address.</p>
<!-- INDENTATION -->
<p>Even if you use this flag, the interface could well be in
promiscuous mode as other applications may have enabled
it.</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-t | --trace-level</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>This flag specifies the level of <b>ntop</b> tracings on
stdout. The trace level ranges between 0 (no trace) and 5
(full debug tracings). The default trace value is 3. The
higher is the trace level the more information are printed.
Trace level 1 is used to print errors only, level 2 for both
warnings and errors, and so on.</p>
<!-- INDENTATION -->
<p>Trace level 4 is called &rsquo;noisy&rsquo; and it is. It
also enables a tag on every message, which may be useful for
log watchers.</p>
<!-- INDENTATION -->
<p>Trace level 5 is &rsquo;noisy&rsquo; plus --log-extra 1,
i.e. with a file:line tag on every message.</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-u | --user</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>Specifies the user <b>ntop</b> should run as after it
initializes. The value specified may be either a username or
a numeric user id. The group id used will be the primary
group of the user specified. If this parameter is not
specified, ntop will try to switch first to
&rsquo;nobody&rsquo; and then to &rsquo;anonymous&rsquo;
before giving up.</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-w | --http-server</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p><b>ntop</b> offers an embedded web server so that users
can attach their web browsers to the program and browse
traffic information remotely. This parameter specifies the
port (and optionally the address (i.e. interface)) of the
<b>ntop</b> web server. For example, if started with -w 3000
(the default port), the URL to access <b>ntop</b> is
http://hostname:3000/. If started with a full specification,
e.g. -w 192.168.1.1:3000, <b>ntop</b> listens on only that
address/port combination.</p>
<!-- INDENTATION -->
<p>If -w is set to 0 the HTTP port will not be enabled
(&rsquo;-w 0&rsquo; is accepted only if <b>ntop</b> has been
compiled with HTTPS support and has not been started with
&rsquo;-W 0&rsquo; [see below]).</p>
<!-- INDENTATION -->
<p>Some examples:</p>
<!-- INDENTATION -->
<p><b>ntop -w 3000 -W 0</b> (this is the default setting)
HTTP requests on port 3000 and no HTTPS.</p>
<!-- INDENTATION -->
<p><b>ntop -w 80 -W 443</b> Both HTTP and HTTPS have been
enabled on their most common ports.</p>
<!-- INDENTATION -->
<p><b>ntop -w 0 -W 443</b> HTTP disabled, HTTPS enabled on
the common port.</p>
<!-- INDENTATION -->
<p>An external HTTP server is NOT required NOR supported.
The <b>ntop</b> web server is embedded into the
application.</p>
<!-- INDENTATION -->
<p>By default user/URL administration are password protected
and are accessible initially only user <b>admin</b> with a
password set during the first run of <b>ntop</b></p>
<!-- INDENTATION -->
<p>Users can modify/add/delete users/URLs using ntop itself
- see the Admin tab.</p>
<!-- INDENTATION -->
<p>The passwords, userids and URLs to protect with passwords
are stored in a database file. Passwords are stored in an
encrypted form in the database for further security.</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-z | --disable-sessions</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>This flag disables TCP session tracking. Use it for
better performance or when you don&rsquo;t really need/care
to track sessions.</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-A | --set-admin-password</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>This flag is used to start <b>ntop</b> , set the admin
password and quit. It is quite useful for installers that
may need to automatically set the password for the admin
user.</p>
<!-- INDENTATION -->
<p>-A and --set-admin-password (without a value) will prompt
the user for the password.</p>
<!-- INDENTATION -->
<p>You may set a specific value using
--set-admin-password=value. <b>The = is REQUIRED!</b></p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-B | --filter-expression</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p><b>ntop</b> , similar to what tcpdump does (and using the
same BPF - Berkeley Packet Filter syntax), this allows the
user to specify an expression which restricts the traffic
seen by <b>ntop</b> You may use this to select only the
traffic of interest. For instance, suppose you are
interested only in the traffic generated/received by the
host jake.unipi.it. <b>ntop</b> can then be started with the
following filter: &rsquo;ntop -B &quot;src host
jake.unipi.it or dst host jake.unipi.it&quot;&rsquo;. i</p>
<!-- INDENTATION -->
<p>See the &rsquo;expression&rsquo; section of the
<b>tcpdump</b> man page for further information about BPF
filters.</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-D | --domain</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>This identifies the local domain suffix, e.g. ntop.org.
It may be necessary, if <b>ntop</b> is having difficulty
determining it from the interface.</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-E | --enable-external-tools</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>By default <b>ntop</b> does not take advance of lsof even
if present. Use this flag if you want make <b>ntop</b>
enable it&rsquo;s use of lsof if lsof is present.</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-F | --flow-spec</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>It is used to specify network flows similar to more
powerful applications such as NeTraMet. A flow is a stream
of captured packets that match a specified rule. The format
is</p>
<!-- INDENTATION -->
<p><b>&lt;flow-label&gt;=&rsquo;&lt;matching
expression&gt;&rsquo;[,&lt;flow-label&gt;=&rsquo;&lt;matching
expression&gt;&rsquo;]</b></p>
<!-- INDENTATION -->
<p>, where the label is used to symbolically identify the
flow specified by the expression. The expression format is
specified in the appendix. If an expression is specified,
then the information concerning flows can be accessed
following the HTML link named &rsquo;List
NetFlows&rsquo;.</p>
<!-- INDENTATION -->
<p>For instance define two flows with the following
expression <b>LucaHosts=&rsquo;host jake.unipi.it or host
pisanino.unipi.it&rsquo;,GatewayRoutedPkts=&rsquo;gateway
gateway.unipi.it&rsquo; .</b></p>
<!-- INDENTATION -->
<p>All the traffic sent/received by hosts jake.unipi.it or
pisanino.unipi.it is collected by <b>ntop</b> and added to
the LucaHosts flow, whereas all the packet routed by the
gateway gateway.unipi.it are added to the GatewayRoutedPkts
flow. If the flows list is very long you may store in a file
(for instance flows.list) and specify the file name instead
of the actual flows list (in the above example, this would
be &rsquo;ntop -F flows.list&rsquo;).</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-K | --enable-debug</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>Use this flag to simplify application debug. It does
three things: 1. Does not fork() on the &quot;read
only&quot; html pages. 2. Displays mutex values on the
configuration (info.html) page. 3. (If available -
glibc/gcc) Activates an automated backtrace on application
errors.</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-L | --use-syslog=facility</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>Use this flag for using the syslog instead of stdout.
Please note that if ntop (ever) forks a child, regardless of
this setting, the syslog will be used for this child. The
(optional) parameter value indicates the facility (e.g.
daemon, security) to be used for logging, using
--use-syslog=facility. <b>The = is REQUIRED!</b></p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-M | --no-interface-merge</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>Forces <b>ntop</b> not to merge network interfaces
together. This means that <b>ntop</b> will collect
statistics for each interface and report them separately -
see Admin | Switch NIC to select which interface to
report.</p>
<!-- INDENTATION -->
<p>Note that the netFlow and sFlow plugins will force the
setting of -M.</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-O | --output-packet-path</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>Base path for the ntop-suspicious-pkts.XXX.pcap and
normal packet log file (in tcpdump format). If the base path
is a directory you have to append a / to the string for this
to work.</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-P | --db-file-path</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>This specifies where <b>ntop</b> db and preferences files
are created.</p>
<!-- INDENTATION -->
<p>Note that the default, &quot;.&quot; may not be what you
expect when running <b>ntop</b> as a daemon or Win32
service. Setting an explicit value is <b>STRONGLY</b>
recommended.</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-Q | --spool-file-path</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>This specifies where <b>ntop</b> spool db files are
created. If not specified is set to the same value of the db
file path (see option above).</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-U | --mapper</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>Specifies the URL of the mapper.pl utility. <b>ntop</b>
creates a hyperlink to this URL by appending ?host=xxxxx and
creates a clickable button. Any type of host lookup could be
performed, but this is intended to lookup the geographical
location of the host.</p>
<!-- INDENTATION -->
<p>A cgi-based mapper interface to http://www.multimap.com
is part of the <b>ntop</b> distribution [see
www/Perl/mapper.pl]).</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-V | --version</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>Prints <b>ntop</b> version information and then
exits.</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>-W | --https-server</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>If <b>ntop</b> has been compiled with HTTPS support (via
OpenSSL), this flag can be used to set the HTTPS port and
address. If the user specifies &rsquo;-W 0&rsquo;, HTTPS
support is disabled. This is the default (disabled).</p>
<!-- INDENTATION -->
<p>For more information, see the -w parameter above.</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>--disable-stopcap</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>Return <b>ntop</b> to the old (v2.1) behavior on a memory
error. The default of stopcap enabled makes the web
interface available albeit with static content until
<b>ntop</b> is shutdown.</p>
</td>
</table>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>--log-extra</b></p></td>
</table></p>
<!-- INDENTATION -->
<table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="13%"></td>
<td width="86%">
<p>Setting 1 adds a [file:line] to the beginning of every
log message. Setting 2 adds a [MSGIDnnnnnnn] tag at the end
of every log message. The nnnnnnn value should be unique
number for every message and should be stable across
<b>ntop</b> releases. Both are useful for debugging and for
using log watching and filtering packages.</p>
</td>
</table>
<a name="WEB VIEWS"></a>
<h2>WEB VIEWS</h2>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p>While <b>ntop</b> is running, multiple users can access
the traffic information using conventional web browsers. The
main HTML page is divided is three frames. The top frame is
a familiar tabbed navigation bar, containing items such as
&rsquo;Total&rsquo;, &rsquo;Sent&rsquo; and &rsquo;IP
Protos&rsquo;. The left frame allows users to select the
specific traffic view from among those for the tab. The
resulting data will be displayed in the right frame.</p>
</td>
</table></p>
<a name="NOTES"></a>
<h2>NOTES</h2>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>ntop</b> requires a number of external tools. Other
tools are optional, but add to the program&rsquo;s
capabilities.</p>
<!-- INDENTATION -->
<p>Required libraries include:</p>
<!-- INDENTATION -->
<p><b>libpcap</b> from http://www.tcpdump.org/</p>
<!-- INDENTATION -->
<p>The Win32 version makes use of <b>libpcap for Win32</b>
which may be downloaded from
http://winpcap.polito.it/install/default.htm). WARNING: The
2.x series of <b>libpcap for Win32</b> releases will NOT
support SMP machines.</p>
<!-- INDENTATION -->
<p><b>gdbm</b> from
http://www.gnu.org/software/gdbm/gdbm.html</p>
<!-- INDENTATION -->
<p><b>ntop</b> requires a POSIX threads library. Although a
single-threaded version of <b>ntop</b> can be built from the
source if requested during ./configure, it is not
recommended for more than trivial usage.</p>
<!-- INDENTATION -->
<p>Optional libraries include:</p>
<!-- INDENTATION -->
<p>The <b>gd</b> library, for the creation of gif files,
available at http://www.boutell.com/gd/. ntop supports both
gd 1.X and 2.X</p>
<!-- INDENTATION -->
<p>The <b>libpng</b> library, for the creation of png files,
available at http://www.libpng.org/pub/png/libpng.html.</p>
<!-- INDENTATION -->
<p>(if an https:// server is desired) <b>openSSL</b> from
the OpenSSL project available at http://www.openssl.org.</p>
<!-- INDENTATION -->
<p>The <b>rrdtool</b> is required by the rrd plugin
(included in the myrrd/ directory). rrdtool creates
&rsquo;Round-Robin databases&rsquo; which are used to hold
and graph historical data. The rrdtool home page is
http://people.ee.ethz.ch/~oetiker/webtools/rrdtool/</p>
<!-- INDENTATION -->
<p>The <b>sflow</b> Plugin is courtesy of and supported by
InMon Corporation, http://www.inmon.com/sflowTools.htm.</p>
<!-- INDENTATION -->
<p>There are other optional libraries. See the output of
./configure for a fuller listing.</p>
<!-- INDENTATION -->
<p>An optional tool, which <b>ntop</b> will utilize if
available, is <b>lsof</b> available from
ftp://vic.cc.purdue.edu/pub/tools/unix/lsof/README.</p>
<!-- INDENTATION -->
<p>lsof is used to present a remote view of the open files
on the <b>ntop</b> host.</p>
<!-- INDENTATION -->
<p>Note that lsof must be configured suid root to enable
it&rsquo;s use. <b>The user is cautioned to fully understand
the security implications of this setting before enabling
it. ntop</b> will function quite properly without the lsof
tool.</p>
<!-- INDENTATION -->
<p>Tool locations are current as of July 2003 - please send
email to report new locations or dead links.</p>
</td>
</table></p>
<a name="SEE ALSO"></a>
<h2>SEE ALSO</h2>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p><b>top</b>(1), <b>tcpdump</b>(8). <b>pcap</b>(3).</p>
</td>
</table></p>
<a name="USER SUPPORT"></a>
<h2>USER SUPPORT</h2>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p>Please send bug reports to the ntop-dev
&lt;ntop-dev@ntop.org&gt; mailing list. The ntop
&lt;ntop@ntop.org&gt; mailing list is used for discussing
ntop usage issues. In order to post messages on the lists a
(free) subscription is required in order to limit/avoid
spam. Please do NOT contact the author directly unless this
is a personal question.</p>
<!-- INDENTATION -->
<p>Commercial support is available under request. Please see
the ntop site for further info.</p>
<!-- INDENTATION -->
<p>Please send code patches to &lt;patch@ntop.org&gt;.</p>
</td>
</table></p>
<a name="AUTHOR"></a>
<h2>AUTHOR</h2>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p>ntop&rsquo;s author is Luca Deri (http://luca.ntop.org/)
who can be reached at &lt;deri@ntop.org&gt;.</p>
</td>
</table></p>
<a name="LICENCE"></a>
<h2>LICENCE</h2>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p>ntop is distributed under the GNU GPL licence
(http://www.gnu.org/).</p>
</td>
</table></p>
<a name="ACKNOWLEDGMENTS"></a>
<h2>ACKNOWLEDGMENTS</h2>
<!-- INDENTATION -->
<p><table width="100%" border=0 rules="none" frame="void"
       cols="2" cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="89%">
<p>The author acknowledges the Centro Serra of the
University of Pisa, Italy (http://www-serra.unipi.it/) for
hosting the ntop sites (both web and mailing lists), and
Burton Strauss &lt;burton@ntopsupport.com&gt; for his help
and user assistance. Many thanks to Stefano Suin
&lt;stefano@ntop.org&gt; and Rocco Carbone
&lt;rocco@ntop.org&gt; for contributing to the project.</p>
</td>
</table></p>
<hr>
</body>
</html>
