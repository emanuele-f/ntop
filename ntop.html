Content-type: text/html

<HTML><HEAD><TITLE>Manpage of NTOP</TITLE>
</HEAD><BODY>
<H1>NTOP</H1>
Section: Maintenance Commands (8)<BR>Updated: December 2001<BR><A HREF="#index">Index</A>
<A HREF="http://localhost/cgi-bin/man/man2html">Return to Main Contents</A><HR>

<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

ntop - display top network users
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<B>ntop</B>

[<B>-a</B>|<B>--access-log-path</B>

<I>&lt;path&gt;</I>]

[<B>-c</B>|<B>--sticky-hosts]</B>

[<B>-f</B>|<B>--traffic-dump-file</B>

<I>file&gt;</I>]

[<B>-g</B>|<B>--cisco-netflow-host</B>

<I>&lt;host:port&gt;</I>]

[<B>-h</B>|<B>--help</B>]

[<B>-j</B>|<B>--border-sniffer-mode</B>]

[<B>-k</B>|<B>--filter-expression-in-extra-frame</B>]

[<B>-l</B>|<B>--pcap-log</B>

<I>&lt;path&gt;</I>]

[<B>-m</B>|<B>--local-subnets</B>

<I>&lt;addresses&gt;</I>]

[<B>-n</B>|<B>--numeric-ip-addresses</B>]

[<B>-p</B>|<B>--protocols</B>

<I>&lt;list&gt;</I>]

[<B>-q</B>|<B>--create-suspicious-packets</B>]

[<B>-r</B>|<B>--refresh-time</B>

<I>&lt;number&gt;</I>]

[<B>-s</B>|<B>--max-hash-size</B>

<I>&lt;number&gt;</I>]

[<B>-t</B>|<B>--trace-level</B>

<I>&lt;number&gt;</I>]

[<B>-w</B>|<B>--http-server</B>

<I>&lt;port&gt;</I>]

[<B>-A</B>|<B>--accuracy-level</B>

<I>&lt;number&gt;</I>]

[<B>-B</B>|<B>--filter-expression</B>

<I>expression</I>]

[<B>-D</B>|<B>--domain</B>

<I>&lt;name&gt;</I>]

[<B>-F</B>|<B>--flow-spec</B>

<I>&lt;specs&gt;</I>]

[<B>-M</B>|<B>--no-interface-merge</B>]

[<B>-N</B>|<B>--no-nmap</B>]

[<B>-P</B>|<B>--db-file-path</B>

<I>&lt;path&gt;</I>]

[<B>-R</B>|<B>--filter-rule</B>

<I>&lt;file&gt;</I>]

[<B>-S</B>|<B>--store-mode</B>

<I>&lt;number&gt;</I>]

[<B>-U</B>|<B>--mapper</B>

<I>&lt;URL&gt;</I>]

[<B>-V</B>|<B>--version]</B>

[<B>-1</B>|<B>--no-throughput-update</B>]

[<B>-2</B>|<B>--no-idle-hosts</B>]

[<B>--throughput-bar-chart</B>]

[<B>--no-admin-password-hint</B>]

<P>
Not available on micro-ntop:
<P>
[<B>-e</B>|<B>--max-table-rows</B>

<I>&lt;number&gt;</I>]



Unix options:
<P>
[<B>-d</B>|<B>--daemon</B>]

[<B>-i</B>|<B>--interface</B>

<I>&lt;name&gt;</I>]

[<B>-u</B>|<B>--user</B>

<I>&lt;user&gt;</I>]

[<B>-E</B>|<B>--enable-external-tools</B>]

[<B>-K</B>|<B>--enable-debug</B>]

[<B>-L</B>|<B>--enable-syslog</B>]

<P>
Win32 option:
<P>
[<B>-i</B>|<B>--interface</B>

<I>&lt;number&gt;</I>]

<P>
mySQL options:
<P>
[<B>-b</B>|<B>--sql-host</B>

<I>&lt;host:port&gt;</I>]

[<B>-v</B>|<B>--mysql-host</B>

<I>&lt;username:password:dbName&gt;</I>]

<P>
openSSL option:
<P>
[<B>-W</B>|<B>--https-server</B>

<I>&lt;port&gt;</I>]

<P>
<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<B>ntop</B>

shows the current network usage. It displays a list of hosts that are
currently using the network and reports information concerning the (IP and non-IP) 
traffic generated by each host. 
<B>ntop</B>

can be started either in a terminal window (see
<B>intop</B>

) or in
web mode. In the latter case, a web browser is needed to use the
program. 
<P>
<P>

<A NAME="lbAE">&nbsp;</A>
<H2>COMMAND-LINE OPTIONS</H2>

<P>

2 -a --access-log-path
By default 
<B>ntop</B>

logs HTTP accesses in the file ntop.access.log in the current directory. Use this flag to specify the path of the file where HTTP accesses will be logged. Each log entry is in Apache-like style. The only difference between Apache and 
<B>ntop</B>

is that .B ntop
added a new column has been added. Such column contains the time (in milliseconds) that ntop needed in order to serve the request. 
<P>

2 -b --sql-host
Exports
<B>ntop</B>

traffic information into a SQL database. The flag specifies (in http-like host format) the address (IP:port) of a SQL client. The database/ directory part of ntop contains a few clients. Please use one of those.
<P>

2 -c --sticky-hosts
By default idle hosts are periodically purged from memory. Use this flag to prevent idle hosts from being purged from memory. NOTE: if idle hosts are kept in memory you can experience severe memory usage.
<P>

2 -d --daemon
This flag causes ntop to become a daemon, i.e. it is started in background and detached from the terminal.
<P>

2 -e --max-table-rows
Is the maximum number of HTML table rows that
<B>ntop</B>

will display. 
<P>

2 -f --traffic-dump-file
Specifies the file containing tcpdump captured traffic that has to be used by ntop. Note: if you specify -f ntop will not capture any traffic after the file has been read. This option is mostly used for debug purposes.
<P>

2 -g --cisco-netflow-host
Exports
<B>ntop</B>

traffic information in Cisco NetFlow V5 (<A HREF="http://www.cisco.com/warp/public/cc/pd/iosw/ioft/neflct/tech/napps_wp.htm)">http://www.cisco.com/warp/public/cc/pd/iosw/ioft/neflct/tech/napps_wp.htm)</A> format. The flag specifies (in http-like host format) the address (IP:port) of a NetFlow client such as <A HREF="ftp://ftp.net.ohio-state.edu/users/maf/cisco/.">ftp://ftp.net.ohio-state.edu/users/maf/cisco/.</A>
<P>

2 -h --help
Print help information for 
<B>ntop</B>

, including usage.
<P>

2 -i --interface 
Specifies the network interface used by
<B>ntop</B>

If multiple interfaces are used (this feature is available only if ntop is compiled with thread support) they have to be separated with a comma. For instance -i &quot;eth0,lo&quot;. Traffic information obtained by all the interfaces is merged together as if the traffic would have been produced by one interface. Use the -M flag for not merging traffic.
<P>
Win32 note: This is the number of the interface, not it's name. Use ??? to see a list of interfaces.
<P>

2 -j --border-sniffer-mode
When this flag is used, ntop is supposed to be installed on a line where traffic is mirrored from a switch or another network appliance.
<P>

2 -k --filter-expression-in-extra-frame
When this flag is used, the current filter expression is printed in an extra frame and thus always visible.
<P>

2 -l --pcap-log
Dumps the network traffic captured by ntop in a file in pcap format (useful for debug).
<P>

2 -m --local-subnets
This flag allows users to specify the subnets whose traffic is considered local. The format is &lt;network address&gt;/&lt;# subnet mask bits&gt;[,&lt;network address&gt;/&lt;# subnet mask bits&gt;]. For instance &quot;131.114.21.0/24,10.0.0.0/255.0.0.0&quot;.
<P>

2 -n --numeric-ip-addresses
This causes
<B>ntop</B>

to show numeric IP addresses instead of the symbolic names. This option can useful 
when the DNS is not present or quite slow.  You can toggle the address format 
(numeric vs. symbolic) by pressing the
<B>n</B>

key while 
<B>ntop</B>

is running.
<P>

2 -p --protocols
It is used to specify the TCP/UDP protocols that
<B>ntop</B>

will monitor. The format is &lt;label&gt;=&lt;protocol list&gt; [, &lt;label&gt;=&lt;protocol list&gt;], where
label is used to symbolically identify the &lt;protocol list&gt;. The format of &lt;protocol list&gt;
is &lt;protocol&gt;[|&lt;protocol&gt;], where &lt;protocol&gt; is either a valid protocol specified inside the
/etc/services file or a numeric port range (e.g. 80, or 6000-6500). If the -p flag is omitted the following 
default value is used: &quot;FTP=ftp|ftp-data,HTTP=http|www|https,DNS=name|domain,Telnet=telnet|login,NBios-IP=netbios-ns|netbios-dgm|netbios-ssn,Mail=pop-2|pop-3|kpop|smtp|imap|imap2,SNMP=snmp|snmp-trap,NEWS=nntp,NFS=mount|pcnfs|bwnfs|nfs|nfsd-status,X11=6000-6010,SSH=ssh&quot;. If the &lt;protocol list&gt; is very long you may store in a file (for instance protocol.list) the value of the &lt;protocol list&gt; and specify the file name instead of the &lt;protocol list&gt; (in above example you will invoke 'ntop -p protocol.list').
<P>

2 -q --create-suspicious-packets
Forces ntop to create a file ntop-suspicious-pkts.XXX.pcap (XXX is the interface name) for each network interface where are stored suspicious packets. The file is in pcap format (tcpdump).
<P>

2 -r --refresh-time
Specifies the delay (in seconds) between screen updates (the default is 3 seconds). If the -l flag is used, it specifies how often entries are logged in the log file. Please
note that if the delay is very short (1 second for instance), ntop might not
be able to process all the network traffic.
<P>

2 -s --max-hash-size
The maximum hash size can be adjusted to values below the default value of 32,768 if desired.  This will limit the maximum
amount of memory
<B>ntop</B>

will use.  The value must be greater than or equal to 64.
<P>

2 -t --trace-level
This flag specifies the level of
<B>ntop</B>

tracings on stdout. The trace level ranges between 0 (no trace) and 5 (full debug tracings). The default trace value is 3. The higher is the trace level the more information are printed. Trace level 1 is used to print errors only, level 2 for both warnings and errors, and so on. 
<P>

2 -u --user
Specifies the user
<B>ntop</B>

should run as after it initializes. The value specified may be either a
username or a numeric user id. The group id used will be the primary group of
the user specified.
<P>

2 -v --mysql-host
Specifies the mySQL database connection information (user:password:database:host).
<P>

2 -w --http-server
<B>ntop</B>

sports and embedded web server so that users can attach their web browsers to the specified port and browse 
traffic information remotely. Supposing to start
<B>ntop</B>

at the port 
<B>3000 </B>

(default port), the URL to access is
<A HREF="http://hostname:3000/.">http://hostname:3000/.</A> Users and URLs to protect with passwords are
stored in a database file. By default user/URL administration
are accessible uniquely by the user 
<B>admin</B>

with password
<B>admin</B>


Passwords are stored in an encrypted form into the database for
further security. Please note that an HTTP server is NOT
needed but it's embedded into the application. If -w is set to 0 the HTTP port will not be enabled ('-w 0' is accepted only if 
<B>ntop</B>

<BR>&nbsp;has&nbsp;been&nbsp;compiled&nbsp;with&nbsp;HTTPS&nbsp;support&nbsp;and&nbsp;
<B>ntop </B>

has not been started with '-W 0' [see below]).
You can also use the IP:Port notation to bind ntop to the specified IP-Address, e.g.
<B>-w 127.0.0.1:3000</B>

<P>

2 -A --accuracy-level
This flag specifies the level of
<B>ntop's</B>

traffic analysis accuracy. Level 2 (high accuracy) is full accuracy. Level 1 (medium accuracy): ntop filters out non-local traffic and disables protocol decoding. Level 0 (low accuracy): ntop acts as level 1 and also disables TCP session handling. This flag has to be used when the network is overloaded and ntop can't keep up with the current traffic.
<P>

2 -B --filter-expression
<B>ntop</B>

, similar to what tcpdump does, allows users to specify an expression
that restricts the type of traffic handled by
<B>ntop</B>

hence to select only the traffic of interest. For instance, suppose to
be interested only in the traffic generated/received by the host
jake.unipi.it. 
<B>ntop</B>

can then be started with the following filter: 'ntop src host jake.unipi.it 
or dst host jake.unipi.it'. See the
<B>tcpdump</B>

man page for further information about this topic.
<P>

2 -D --domain
This identifies the local domain suffix, e.g. ntop.org, if
<B>ntop</B>

is having difficulty determining it from the interface.
<P>

2 -E --enable-external-tools
By default ntop does not take advance of lsof/nmap even if present. Use this flag if you want make ntop aware of such tools (if present).
<P>

2 -F --flow-spec
It is used to specify network flows similar to more powerful applications such as NeTraMet. A flow is a stream of captured packets that match a specified rule. The format is &lt;flow-label&gt;='&lt;matching expression&gt;'[,&lt;flow-label&gt;='&lt;matching expression&gt;'], where the label is used to symbolically identify the flow specified by the expression. The expression format is specified in the appendix. If an expression is specified, then the information concerning flows can be accessed following the HTML link named 'List NetFlows'.
For instance suppose to define two flows with the following expression &quot;LucaHosts='host jake.unipi.it or host pisanino.unipi.it',GatewayRoutedPkts='gateway gateway.unipi.it'&quot;. All the traffic sent/received by hosts jake.unipi.it or pisanino.unipi.it is collected by
<B>ntop</B>

and added to the LucaHosts flow, whereas all the packet routed by the gateway gateway.unipi.it are added to the GatewayRoutedPkts flow. If the flows list is very long you may store in a file (for instance flows.list) the list of flows and specify the file name instead of the flows list (in above example you will invoke 'ntop -F flows.list').
<P>

2 -K --enable-debug
Use this flag to simplify application debug (eg. fork() is not used etc.)
<P>

2 -L --enable-syslog
Use this flag for using the syslog instead of stdout. Please note that if ntop (ever) forks a child, in any case the syslog will be used for this child.
<P>

2 -M --no-interface-merge
Forces ntop not to merge network interfaces together. This means that ntop will collect statistics for each interface and will not merge data together.
<P>

2 -N --no-nmap
Forces ntop not to use nmap (if it is installed).
<P>

2 -P --db-file-path
This allows to specify where db-files are searched or created (default &quot;.&quot;). In addition DBPATH/html is added to the searchlist for the WEB-files
<P>

2 -R --filter-rule
Specifies the filter rules used by ntop for emitting alerts and warnings when the traffic matches the specified rules. Shall you need further details about filter rules, please refer to ntop-rules (8) man page.
<P>

2 -S --store-mode
Use this flag for telling ntop to save information about host traffic on shutdown. Valid values are: 0 = don't store hosts, 1 = store all hosts, 2 = store only local hosts. This flag allows ntop not to loose traffic stats across multiple ntop sessions. Please note that information about TCP session is (obviously) lost.
<P>

2 -U --mapper
It specifies the UTR of the mapper.pl utility (it's part of the ntop distribution [see www/Perl/mapper.pl]) for displaying host location. If you don't want to install a mapper use <A HREF="http://jake.ntop.org/cgi-bin/mapper.pl">http://jake.ntop.org/cgi-bin/mapper.pl</A>
<P>

2 -V --version
Prints 
<B>ntop </B>

version information and then exits.
<P>

2 -W --https-server
If 
<B>ntop</B>

has been compiled with HTTPS support (via OpenSSL), this flag can be used to set the HTTPS port (default 
<B>3001</B>

). If the user specifies '-W 0', HTTPS support is disabled. Some examples: 1. 
<B>ntop -w 80 -W 443 </B>

(both HTTP and HTTPS have been enabled at their default ports) 2. 
<B>ntop -w 0 -W 443 </B>

(HTTP disabled, HTTPS enabled at the default port).
You can also use the IP:Port notation to bind ntop to the specified IP-Address, e.g.
<B>-w 127.0.0.1:3001</B>

<P>

2 -1 --no-throughput-update
Turns off the calculation by 
<B>ntop</B>

of the minute by minute throughput of the network(s).
<P>

2 -2 --no-idle-hosts
Turns off the periodic purging of idle hosts from the tables.
<P>

--throughput-bar-chart
Format the throughput charts with bars instead of as an area chart.
<P>

--no-admin-password-hint
Supppresses the hint about the (default) admin password in the dialog boxes.
<P>
<A NAME="lbAF">&nbsp;</A>
<H2>WEB VIEWS</H2>

While
<B>ntop</B>

is running, multiple users can access the traffic information using conventional web browsers. The main HTML page, is divided is two frames. The left frame allows users to select the traffic view that will be displayed in the right frame. Available sections are: sort traffic by data sent, sort traffic by data received, traffic statistics, active hosts list, remote to local (i.e. inside the subnet defined for the network board from which the program is currently sniffing) IP traffic, local to remote IP traffic, local to local IP traffic, list of active TCP sessions, IP protocol distribution statistics, IP protocol usage, IP traffic matrix.
<P>
<A NAME="lbAG">&nbsp;</A>
<H2>NOTES</H2>

<B>ntop</B>

requires a number of external tools.  Other tools are optional, but add to the program's capabilities.
<P>
<P>
Operating system header files and the Gnu gcc compiler and glibc libraries (<A HREF="http://www.gnu.org),">http://www.gnu.org),</A> including the glibc development libraries.  
<P>
Required libraries include (see the output of ./configure for a fuller listing) Posix threads, ncrypt, readline and:
<P>
<B>libpcap</B>

from <A HREF="http://www.tcpdump.org/">http://www.tcpdump.org/</A> (The Win32 version makes use of
<B>libpcap for Win32</B>

which may be downloaded from <A HREF="http://www.netgroup.polito.it/WinPcap/install/).">http://www.netgroup.polito.it/WinPcap/install/).</A>
<P>
<B>gdb</B>

from <A HREF="http://www.gnu.org/software/gdbm/gdbm.html">http://www.gnu.org/software/gdbm/gdbm.html</A>
<P>
Optional libraries include:
<P>
The 
<B>gdchart</B>

library, available at <A HREF="http://www.fred.net/brv/chart/.">http://www.fred.net/brv/chart/.</A>
<P>
The
<B>gd</B>

library, for the creation of gif files, available at <A HREF="http://www.boutell.com/gd/">http://www.boutell.com/gd/</A> (included with gdchart).
<P>
The
<B>libpng</B>

library, for the creation of png files, available at 
<P>
<B>mySQL</B>

available at <A HREF="http://www.mysql.com/">http://www.mysql.com/</A>
<P>
<B>openSSL</B>

from the OpenSSL project, if an https:// server is desired, available at <A HREF="http://www.openssl.org.">http://www.openssl.org.</A>
<P>
The sflow Plugin is courtesy of and supported by InMon Corporation, <A HREF="http://www.inmon.com/sflowTools.htm.">http://www.inmon.com/sflowTools.htm.</A>
<P>
Options tools - which
<B>ntop</B>

will utilize if available - include
<B>nmap (<A HREF="http://www.insecure.org)">http://www.insecure.org)</A></B>

and
<B>lsof (<A HREF="ftp://vic.cc.purdue.edu/pub/tools/unix/lsof/README).">ftp://vic.cc.purdue.edu/pub/tools/unix/lsof/README).</A></B>

<P>
<A NAME="lbAH">&nbsp;</A>
<H2>SEE ALSO</H2>

<B><A HREF="http://localhost/cgi-bin/man/man2html?1+intop">intop</A></B>(1),

<B><A HREF="http://localhost/cgi-bin/man/man2html?8+ntop-rules">ntop-rules</A></B>(8),

<B><A HREF="http://localhost/cgi-bin/man/man2html?1+top">top</A></B>(1),

<B><A HREF="http://localhost/cgi-bin/man/man2html?8+tcpdump">tcpdump</A></B>(8).

<A NAME="lbAI">&nbsp;</A>
<H2>AUTHOR</H2>

Please send bug reports to the ntop mailing list &lt;<A HREF="mailto:ntop@ntop.org">ntop@ntop.org</A>&gt;.
ntop's author is Luca Deri and can be reached at <A HREF="mailto:deri@ntop.org">deri@ntop.org</A>.
Tool locations are current as of February 2002 - please send email to report new locations or dead links.
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">COMMAND-LINE OPTIONS</A><DD>
<DT><A HREF="#lbAF">WEB VIEWS</A><DD>
<DT><A HREF="#lbAG">NOTES</A><DD>
<DT><A HREF="#lbAH">SEE ALSO</A><DD>
<DT><A HREF="#lbAI">AUTHOR</A><DD>
</DL>
<HR>
This document was created by
<A HREF="http://localhost/cgi-bin/man/man2html">man2html</A>,
using the manual pages.<BR>
Time: 23:13:29 GMT, February 16, 2002
</BODY>
</HTML>

